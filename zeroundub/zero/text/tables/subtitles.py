# ruff: noqa: E501 # pylint: disable=line-too-long
import os
import hashlib

from typing import BinaryIO


subtitles_en_encoded = {
    0: "9c0c40e254d05a0d4bca7b7037",
    1: "6e56c3e4f9f869edc4cabfd14ec522c20a9640b4bcb5d4aabd456fcf5168673564a73a78300573ae1a69fc0021a41d655c3f",
    2: "63251060755875725472f41c2114ed683ee972efe1756eea7360ff6412ff6dd2b06250ff2630b172c2fe2f",
    3: "34de2115c366b3c873c2e66988df2f209e",
    4: "6981967697a521eeb62105ab64319d21728465846aba6f802f",
    5: "7c677d75d37129773566a66cdb6f8d23246aec24b424516af269840f42763f689273902657684866f46898731a7c106ddb6de97e947b4c663c7aa1",
    6: "48da7d8e7b10651278b467ae7e6a6e512b3e62f56fcf",
    7: "637d2c106dd22c85753e623961212d72437245735a03",
    8: "4842076f4e4f5903766e3f6149935f69453f6148465d4b704e08",
    9: "64500cf4889078414c573b59425d08405faf899a75507c443f744a3f5e705d7a43754304",
    10: "696a736c484000aa4b704b7245474d02287e0040484443e37f09474a5b434f4c6c8a",
    11: "4b75480e48007649470e7265094b57f98e976c5825594f513f5c466d643f404e4c4c4c6b794d09514c04",
    12: "9a4e404153567af7889a70026844767749155f7a437a4d6945424a717a3f4c094291457004",
    13: "484446460e4a7a3d5246417b0efb71026b5b475d094d9b06444a6b0a7a0c424c417f2246403f48484244fb939171056c0c6873496d487e5270596f5506",
    14: "6a3f7b7a415d008b447e4b6c55",
    15: "4f4146463e774b02687d5a12f163404742de4042573f4b6c4d5707",
    16: "0011637a5c474c4b7c7b513b1e07badace2d1a29",
    17: "78774a5e3b43486f4344454c743331072ab75e3c593f615b060e767e4b47444042f32e5d08",
    18: "7d414459de5142563f56580d3f497e42417641474b3132072376f9da976c0a4b474a027c454e7a3d774c524d07",
    19: "6376775c08",
    20: "6c570f8d07514546483fe28d9034557a4974500d6844497843066329737c6c5d00427e4b6d48de4f5a414f3f4d5f094b5ef98e97715031",
    21: "6f68583b426c0a4f78436b3e4e0a48465d400d524b446bf4414c433f4846086a46005877446c3b5c71434b4c00",
    22: "560df09f9360027e5f3f6f447058785831023555454e7a6977444747206c4b6c0c9d4244424b71790c76543f44f38c6907",
    23: "64444b535a50310435",
    24: "61570942697352737857085e4f6c3c414c57f3d4",
    25: "a87c436b0c76500d6f424a6c3d6f4541497e15",
    26: "5749925f063031",
    27: "6847463f6d40404b4c464803746a5d5631320224",
    28: "7d036843f89e9a613f59790c6c430d4f733d79444744207a446658734571440896455e4c06",
    29: "675d075d027c484f4802",
    30: "7e44f7780948055a54464674d0",
    31: "6e72480e5a4f764d5d4676724e094df78a8f714c3f5870114166117d5c455777786d12",
    32: "6355596f0a7345954c08474c3f55444c0f5876f9604d31",
    33: "644e485d055142563f8a427a5811",
    34: "61456202",
    35: "577b44590e727908",
    36: "7a4df98f937002560c6b7a477a117e0e5a4b70697012",
    37: "60540d680a6b449f5d085e476d5243470f613efc61516b1355485e0b",
    38: "724b403f8c456b495d07",
    39: "6d7a4a6a675d08",
    40: "797e755d08",
    41: "6df3968f344f7a0d",
    42: "5251033b657e454b4e76737a08",
    43: "6b4369437a02d035",
    44: "7a425f4c3f7747fb2700085d4c4941064b4c72d00307",
    45: "737a45443f5945440e6841495711",
    46: "7440620c010213",
    47: "7ae5da8b7c4b6c0c6b4b483b604642663c6440575b475c1d",
    48: "568a0a5d3b49596e6f0d7eb67d40484d4c0041443f436f0f",
    49: "560a924e3b5d7e777a3f51415c0c4e4c4a42b69786295a4e47400c",
    50: "5e084d5572494d0c",
    51: "6fab437b683b4a479347470f",
    52: "4e5641445801036076f89edf7c4b720d",
    53: "537443740d7e4270597542040d31",
    54: "4977480952915a7e15",
    55: "514308",
    56: "7c46436b0d4f765452f96603",
    57: "585a504c094c8a0641447c413a",
    58: "650e4a4176493f6a47095c7a6f4c4857f592df7d484c256077765d6d5e084f4f724a4454046d3f8d6878524a4725f9445c5c4f733c4b4c46f78f8c710c3102",
    59: "6b73456c0779445a474a4b714b08444f6c463b416dde5c7754277049570369493f594b4d0d4771705c0c",
    60: "4b404c0e7e705d4857b189df68475a095e46004c47154349735971490e5d4076500d7f91455131",
    61: "5070440e3506",
    62: "6441723d",
    63: "7e415c1c224c964b523b454f536d797544f2c5",
    64: "a66845070106",
    65: "56745f3f5242684a470a5e4b4152034a481c",
    66: "53709311",
    67: "7577495d096c3c5d4144e2c5",
    68: "b26d027a557a680d",
    69: "52543f5566496807",
    70: "7d4b7e693f5a4853de5e734b6b13",
    71: "605c09513f5243094b496cfd270008",
    72: "605d025ede6b42436a625f02",
    73: "4b757a094474475b0e766f094f4cf89b9365530f417d7e4e465d48a5",
    74: "645c0e5d3f424648474846543fe6976878450f5c49b6e2fe6b097c60575a46431d",
    75: "6246f9457adf",
    76: "6b6b0b6c0d4d466d5a033f656bb189df674d3f487e51463a",
    77: "4a4b7e5f56115c4b415a705b0706d0",
    78: "7d4e7b533c587a0c46504c406a7357026b42493f5d4f5e792353e5da8b614f0f4140476c0a6e70703f5d4f745a07",
    79: "707e5aee0d8a7646620c474243425d00544f6bfef08b61435c0e6e7a4d4a414eb4",
    80: "60494f5b665606091d",
    81: "6d42406aef8fde",
    82: "504d710b6b3b5570583f427a4f7441444a65783f404c1f",
    83: "ba456c443f444c5a4b0c310719",
    84: "50713e0d6eff88966c01",
    85: "7d47416d3b5f485f3f",
    86: "49463b42564c4c0e5670de745c5b575403",
    87: "4f4a45f7899a280a7f424b436c4f03727c744c00725c09556a71533a",
    88: "7f479153084a5601",
    89: "744e70b69b8d6c0050405d21",
    90: "520a477073385d006c4947523e6a4c3b485a9b0d",
    91: "",
    92: "610e557e70583b45700c5a454b0277744f3f4240f3da927b507a0c6b4a407e09",
    93: "7a52715a0d3133",
    94: "51460e04350b",
    95: "524d985c515b0c31303e",
    96: "604cfd8fd12704",
    97: "784b000c315f404273114d4f594f665b3c517e3d564c417b8a4b4d5512",
    98: "6957016cb68e977102734d6c570d6b43467c783f46460a6f427a0c7c4a5c50914302",
    99: "6e4f455d585c09037a4b494e47094f41464440476c8d3c",
    100: "62467302e2da997b5078496b0354745d5b067a6b576202",
    101: "7e5a0849566a66de47513f534c0c474c495d246f40776d0c7f5e705eb699937b517a4831",
    102: "7d7e4c6d4d095276765b1078475d4f3f8a4c08404630",
    103: "4b46473f69436f5b07f99cdf70455a0e716e6d7f56087a4b7f0e7ef84e7f6f7e0f",
    104: "605d5d0e6896425c0752424c536bb683907c1f",
    105: "600f456b686a0368585c410c57464b3f6b42449f704b6f5531237454034d496f7a0e586b3f5f44454b3f41476e8e794709444af7939127",
    106: "6e40402c570c5470f95f67037a4e5c565c075e450d2c46f98fdf645b555d09424207",
    107: "6e44795b5b6a003fe842767b03744212",
    108: "b340435b05",
    109: "63094d5b516b09556a7f6603",
    110: "72fe9b8b294f544c095c425303567e574b714b20",
    111: "6a0d6f764a754713b7034b414209404b45500e4a7a6c07",
    112: "6b4ffd8fd3345b70593f44423b475c523e694a6f445ce0450c4e4b00",
    113: "5241955606330c",
    114: "6f4478096c4e4c4440b5454b72493f654b6d976d0951527e294b5940484643783e434c303fdfda9c665f434a0e4a7a735b207776500c504b6d754d4e764349a503d0",
    115: "624f514b424548434408415c52034e7afa8ad1",
    116: "55513f5877460d4945537a3d4c415243754f3f6148419a4b4c33015f414a2269f77a0e424c5a51444846413f6f910a507a7c730954734d09497e684c07",
    117: "7cf38edf674a7a0c7e4f5e74085e4770684c4d055747004e4c2259975d480e5677480e46467a3c5c44463b4a485f4a4c30",
    118: "d48f8b345177493f40426e444d483968094144554d004e465c46d2234140463f564d68107d4847474f3f454c5c4c0e436f9f535d2543663e5473726cf3da8b634d3f4a7a464172464e5532",
    119: "6b4140464b0852495a5d428a4c440e4b710d5a414d3f6448444e4a765c57b8",
    120: "b29a66026c5c7651446f085e4f6c095c41577c49494d0f4a67de454b4b02564d4574464c042448444d005046f3da9d9a9c0c60e52def2dfe7fce6c85bc2c367d86499326d1cb38353e14c6f5f825479c7a1e027521fbe59afe0458062f3701312aad9eff570b1d15473c39e9d1",
    121: "b13c798168c06b602f4669577bad6ac9425b7c1a73cf3cee6374744778e01b89735c671032c77dc474477f017ac97fd37b44667670fe60d871723523667361bb702f443766e936927e9f7f7172545ac87e8b727a0c",
    122: "57496dab5e74584b3b4b5359573f6f7a444143750a77498c4c0424497a445c40414f3ee2614755094e44594303567a7a924d7b11427b40294c45510840fa96df695d4c577547575706",
    123: "685de3da9e784d714931a503",
    124: "5e434377435559036f7c76470e",
    125: "6b680a7343904e084f513f52444c0f416db66a5b4c400d4945056f7a975e33",
    126: "4d40094a714678114c680c5d4b780676e5da91665e0f424b446b08775e5d7e404b506e0a",
    127: "56035f4e40480d0831e295df76473f4e66ab457e5f07684f424f0d",
    128: "3133316449416e04",
    129: "524d985c515b0c310f",
    130: "604640433f",
    131: "c2614b4f5b095642534f563f7a8c4d3f504171064445434d4f01f49b9c7f286b433f54457e5f423b524e4f5a3f7f7a454f424433",
    132: "5297416e043102",
    133: "6008404d68015e4c4e4477ec7102684466ab64de5a485415535e4c5b4440550346f3889a25",
    134: "4b414a0e6b3f5e4f7272097c4c447a585a035c4f5a5303427ae58e967a5b3f4379034072464c08",
    135: "5375425c0b070e",
    136: "784b7c71950a62456a020706484d6d01495f4a5a67e26147e54ad0",
    137: "745a465c0e6c414d4b78026f447c5d3b42425109b6b3df7a5e405e5e477b165a4c4077714a3d584b754d4f520e56779f7c03485b444c523b574649434f4d2d574f4d016bb6899a6c0e",
    138: "644e4e6b62690809714141474d3e4b4c727b904f68593e",
    139: "684c4609563f4a46434e456809504a58e4da9b7c5e5600",
    140: "635b3f4c6a45543b455d0369493f484d42432a574e76e5da9875567a0c7ce7425e4c4331000c",
    141: "6f4d405f4d0e56779753064e4858f3295a4909444003080d",
    142: "51777e3c5b4c568a0774783f504f5c067659516f660a7a447b0cf3899c75527a0d",
    143: "5d56593b5a4f7a52064b4170686b0959915f350431",
    144: "6503455b516b3d5f6b5f533d6bfe6c0e6142444493606962042670693d474f5df3b6ff8edf634b73403f4b4c6b584c483e4c7a4d404808",
    145: "6d4740056bde6b745e6d580c484d476be2da926c0e2376476b3b476e5f5a0654730e",
    146: "6149485f5a6a313f9d464d4f3b45710d",
    147: "654741493e",
    148: "794a7a4f52b67f465c495ede4751403f7a4445067947765f4a3b4e4f40762c6bf9da887c476d493f57454850077d4b4e4c46461f",
    149: "674a5c477a060706",
    150: "ad46473f5d7a593f4d42557e7b5c3e6d566958497c42467199117d42430c77434c7a30",
    151: "6b4de4da8c7b57730c72565e6f085b43737d4047056f464b507ad23c70784059494045156a447e11784de29fdf67477e407a470d744e4f0678735b09445d40034b5a7a5a904a5c640c",
    152: "48447809734747085146085d437c5f4b794f439b0f4d687a5e516b73474c490c",
    153: "4b47495bf3da8c665f435d0e4f7e51095c7a6f5d094c75086e4d7e5248d23b4e5b573d4e7a5108545c554f2c68ff96933443735b7e5a5e3b5e527d4043580d",
    154: "59726d4c569b583b4b7148094d58476d330c31",
    155: "6858f37b0e5540474648de524b446b3b4c7e48013d51460a59574751e69f9b29534c4a41704a2353774048795f3f59777a583d4d8a764c6f0f577a475e417e074d474f09563f424c4c30",
    156: "c59f8f7d45444d4d6c0e1b6b480506101c1d1c037d63",
    157: "df45493f407e755f744d903e5e7c5c0771475945465a48036a700e407a2768457af8da907a026b447a03407a5805066d73095e40094e474c7e924c5f09414df2035ae40d4f5174005d4e40064543404c42f80d9643680d6b740c7b4b704d3d465331",
    158: "7c4648efda8b7b4e7b0c6a680c6b407e450d534543566f49156042465e4a7171de46437b084b4b7a72094c48e68e86034c405c0e517a7e46554e4009447e444242568d0a424c6803",
    159: "7ae348076849427e064c46424000544e70b68e9078463f596c035a734d5b433e4469265e47553b4f425170de59485847454a026a5e0e754c583d6f423ff59592710277496d4601115f414f7d453d5b485506585d47567ade7f4f5d7843f8999a655676427800",
    160: "717a5157494b484c5108176b76b9de17182b1c3fdb60",
    161: "5268095a404b4f7e4a0d7b7e494a4b5b91696c065d4701594842493f5441544a534e44035946f3f0926655475b497740027e5409484c4141580f0d5de40d5b7a0d7b7e4f74469b7a096940076c584b434722594b7b3f404b78756f3c4b4d6d4bb69b916d0a4c414056764e5c4305495c5e035a41f946d0",
    162: "65385b7a3b4e78477009694755705d4945035b424545514773b688907b4f6c0c7ee75f7e494d5f30274842454f4d460854444c084b865d455c4b705f02095c7742094141537a5a47f9762341f80e8d5a4b4f4405474c3b5f4472594b02784370783f53414d6ff3d4",
    163: "be344e76586b4f483b4d48547244785e05066f035c964f594e405a09690e517e5a24480868744658463b554f484b4769efda997d456a5e7a03427d0848066942704d472c4f4d088a484909404f454c59436601427e516d0d5a414d3f544d5a509f40417a0f",
    164: "60084d733e4b7e786fb68e8d7541740c70450d685d4a4e3e5e744b41524f414f6d154d904a026f444b45776c403f5c7543440d46423ff7da93685e4a5c0e437c71465f71670c",
    165: "7f46586b7541417a5f0eba1d8a5900031f1312131d03696a",
    166: "6445034276e5999062476d497b035e7440780c4d4f55575d5c40764741148e734353465fab444c3b493ef5929a67563f4379034969495e436c5e33",
    167: "6f46534a7f075d40448d4b027d453b524e7a087b7444754a705fff898bad76224d774542466d71410e44494d6f4f735d9b493f4f713d654c4248da67b67ae567785f24",
    168: "7e45efddf0e8ef5b473e765fda8c61ff60ef264c4a7baa9ceee48a504041556c2d6c4742efda947d466c0c6f4f4c624147413e597c4b07",
    169: "6f48086b5a4b0e4a915c4c7a550943480f6f44560e6b74496b41baf08b7c476d493fe25e0d4807794f4b4d5c01474f7a49430946430d9f2c5a4a6a754a3d4b40544a3b4e4708400e5577496f43067441934347720b",
    170: "65f3e4b69c9691637d65384c6b15682b719fbd3b377d86499b21d1cb3822667bc391e86a0f946955022c2bfcad93e31813553b22473d3ead4997e9500b7f1d063f31e35ddf8c0376ca3bb8728b7e6d68057d337f046fc768b4734f33",
    171: "03780869c970b7787f3e732f1b76b63e87243929614f2a",
    172: "48fb3f9c70734b2d445b41f24cf94f65443c011e49ea01bb407d51534d150e9440af5628545a030057c44fb203764b48480c4ab150e7426a4b4d05104aeb4c87",
    173: "728d4c55434a52c9537007454f0c539353b04e66082b49ec5bd94782087e5a6e410d4ea9050d637a4783499f584a4aef459c5c6e0c3d43ec40b50b52486d4b1b58f649e94570436d4c0c0eca41ac00106c515a104bf3476d100851de55ed5179430e50dd48d75d4f542d0d",
    174: "c0579241d25057561a13c252725d3153b947ae599b405b5c1552ea54905a41427414a0598b5364451447dd44cb1b2d4b5256e95de34f891851560252a44aad5491335952454e44490c4348495a5f5d5e51431f",
    175: "69574a475f59585048160b054e50161903000a0b1a7d77",
    176: "741a58554a54241a0a5528536d",
    177: "722d49655e235b3352684d28496a503e49381a2153255f6f4e385f5b553c5f73533a1a2152331a3a552d542d5b33547b4c3556315b395f71",
    178: "7209494152075b071a05547d094372417d68065b7a697b136e7e5a4941464c0f",
    179: "67027c9f493c4603454a4b414a51793f5b7347520e423f7641595c9f404b4d4a02",
    180: "7d7649f59aac7b4c09487e5a0e56777c5d0849765a42040978a8fb9ff5ff694c4705764f405b3f6e5d5a4f714f4b085f58fce49591ff22",
    181: "6845493b5a46473f7a41475d6b5b0e414711fbe59fdf7943715f764c432741486842024246453b5d4441457e720ef7e2b6979a27",
    182: "67ab49464839e13c5b46604049035c4d6c643c44410e4650438c25417a570efb9fdf7b576b0c70ed0d59414e6c0e4f4246524047400c",
    183: "56004246470be2da9a6247710c744d425a094f7059024f474f7c2d6008424f4c3f9642717f0e41710c6b711144503e5e7c42725e54b8",
    184: "bb916d557e553303643c71095e4c41564a4840035c48455a085a9f5e4731",
    185: "554a0940694d5f0e684c417874437ab696967a5a43475a055949295177725b33115c4543475a450c035242fa92295c4c0869774d572a657a530f5b4e566f4540464a026b433fe29fd1",
    186: "56576b0c6c57447770071c0769004b49574a08776b0b5b3f715b518a0e433f55514d7f441f",
    187: "c59f8f6047724e7a510d1c1b537702021012131d027365",
    188: "6a084a754189074748766c0ee5958a6f436c3e406f4252661d034c576f2c5d404450460a5d095f5cfb9b7d4674754107454b507a274b4a55ff9e9a67026a5f3fe2430d5d4f765d024e494f5e4b4c461d",
    189: "660f687a0c8d4b47713e765905fb838c714e79023fc2590d5e466c2443035f4e40434d085a41087f3f5b40766f4b0295474f70707033",
    190: "7a43764b575876414b08ff89df7047794571e2597e446611444856564c4e494d4107414d8c4b0c",
    191: "577c547a0d594c006b42705f705b44f89d936d027e5b7ee048434c433f5d4d4e4d557347404520",
    192: "53693d559b5b484f526c0d557a0156f3da9d7147710c73fe5f7e48094e435b45005749074741481c",
    193: "576cde5d4a7a3d5241483f41f89fdf77436a5f76e54a3b68415b5a00444a55465a5c4b5020",
    194: "614a450943f0da8b6141554c09404c544f4c7a69087b544d5d4e55162a6b4c4c4ebade5d5e44477b330c424c4f0e7379065d40444011",
    195: "6893077a3c58414b027149f78edf604d3f4876ee12",
    196: "7941423f7c4d534d017c406c76424d3f564f4b9a4b4c3f724f5d5c4d452a4f513f594d40470870f0b6ff94df7847784971ef033532",
    197: "6b5d5d480042544a5a040e4e7a465f050f4970f2da8b7b4c07714b4148062b6a590c7653066c7c4747085646477106424d4e0e98495a4c074f5256433b4f47434d2b4f4fe4919a65303f6f474b03435a545e4b09416c0a4a494e5d4e7a6a4b07",
    198: "ac7457465f0c485eeb06414078494d464a4345b67d410a485d5d7a4c5f3f42902743553b5849705e461f3f650afbda8d614c714571ec0d74695d12464600574f4a4c06",
    199: "7a414f0946915c407649467a4800e4938b66484b6c244d4508554b445f3f41547a7c000d06",
    200: "4852034d4d41955008424b747b3b6157b8daab75497e4176e5483b6b484123444f4a48403b5c4b517a9f5f40763f404e5a4d3f5e73484035",
    201: "683fe1959170476d0c76450d4540543f49504c5d5103415d286c6a724049b6fef3889a2b",
    202: "6b3f4f7e5359585b427b0e43034f494c5b5a0c3103286c775d59de5d4847513f7e4372485c480e",
    203: "4a4472423f4f4cfb9f8d7502774d6c0359454c076f4155465a2b58700043676d41504d018a4e4a4f455d0f5c767a26467069434342027a677a0d46f794d87d005a4a4d30",
    204: "52076d7b4e784e4a7a6f095c467e0341714f977f42475c0148507044245577454e4f3b6f064f4b7e5543f39edf664709475a513f5771456d6e432d6f71547851086bf9da9c75526b596d460d4a41486c5a510d",
    205: "08",
    206: "7346584b513e017e465f4d6db7b6d7968872505415434d514d0151425c7a5307",
    207: "526f00037c404d424c4b409b240f0e767071464b110807237746476d4709476d4608964f547a005f465c0cf79693334e48714b1d02",
    208: "7c49465f493853066c7243465c494f4d4602469b524908",
    209: "7346436b3d5b705d42733e037c46436b116c494bf794f57d4c3f4d3f4844404649700951034b4e4e4143443f",
    210: "4846476d7806414c694bb68e976c57064e464b4819",
    211: "6b4a680e417e423fc20d4f5b427e4502574044f4405d5f507b3f41443f6a447e116d43594511",
    212: "6a7a7152310300b6b29a7852310231",
    213: "df45480975705e47037b49514143463e524f4b7b79471cb8d4f54741423f4d57515b440d0302",
    214: "4c48433f745d035c4943034d435d8a03654c4a7a7a400c310325634c6d41450d0231",
    215: "63067f747bf8dd8b34557e426b03594209447043470340445f470d087e5a22444d6d6b9740416b6f0c6f5b4f7b0cfb9fdf7a4d6b0c6be403",
    216: "4f7440410957415a072d487747423f6849870f",
    217: "6976437243083506",
    218: "4a414f70780c3103",
    219: "67b6999e7a056b0c79e2437f3c5d5a4c004b465f091f0c157b779b5c473f6b5503416a1c",
    220: "7c496c6f0d42586941b6938c34566d55764d4a275d483f5d435a0852424f465c5b40464907207a4f934b5677744c7803000749735c74436b4d43e2d4",
    221: "b47d507649310d030d624e6d47470d060f",
    222: "6e5a03034a7e454372754757d007065d4369480272430eb8d4",
    223: "b63455765f7703594540543f5947514d014c02475a564245d0000c",
    224: "5c424f7e3e595d48590e55765e4b064b7e0d",
    225: "c292966702684d6602",
    226: "6f485048714a025740485a084a46455b0cf45a4a7a3c527255e4958d344f6a5f6bab4f7e3c5d5a4c52450d0809",
    227: "644145465e460cde574d6a3b6d7e07e2959034517343680d0303",
    228: "644e7441564c060f03",
    229: "724f494a095f475d42094d9b0f",
    230: "7677756c3b50f783de1e7677456cab5a7a6508",
    231: "7b0948415543076f410e4576697b016b9640530e6f766f544c522ae295df604a7e583f4e4c7503",
    232: "6d4b041373427a333107010c7e755cde4d414a0266735309417ff848246f4c086b7f4b43095043e388df7b55710c73e24b7e23",
    233: "6054094f4e4f5f0750475b02779f45420e5b0878f98f9170286b447eff0d4e484a7a5b473207467f4633",
    234: "60477246084f427d74de5a4d3f4749310000",
    235: "67744c12c4958f71025e406b425f0307093f7a4a462272575a4c4d7973474c783e7e72456a4d96d13a0c",
    236: "4f407a425e480709315d564c580140470d",
    237: "64565d08934b027058563e066cf38edf644509405d6a245c4c3ffa282a53034b46f87a474d4d09",
    238: "7c917c3d734959483f574111574b4e4b1375724a3e0c4ffe9fdf4c43516d726d082a7a4a7a28644f417f4c5e0d",
    239: "7d449b03444c506a3f6c577b784448056c5c7c6f527a0c72e4390c07f4505d0f5276ee104c7759715841024e4e554700b8b8",
    240: "d5e0979a344476737f0772493a3c56066d4d0e4b4443471146424756974954275d4c3d7749444e1f3102b6e5f9da93784c78062704",
    241: "660e464369450344700a44766b7a0d5a41443f634b6d5e915c286b4803584448583c72407506",
    242: "634074485741350300446e5a5366d0080d",
    243: "764a4be4f3b69e966d00726606494f594e40554858034b4c11",
    244: "7b73430a6b5d76429a7447400365405347094e5d026b4f4626474c55b67d473f6b769b0e4d40426d0d",
    245: "7a464c0d5d774f4046764f7c0e52f6899420071f",
    246: "5d4a7e106c7a455447447649463f746c0de39b967a567a483f4d426c0b",
    247: "74777871095446473f4b484a52604a5855094f91424d6d3326594738614703494245017f4b7ef2d4",
    248: "a86c0ee6585d563f534c4e400e4b5e037e7a7eff90054a7a41465e7a0a4a6b3a6cb56f47710e4e7e53460d266159515f873c",
    249: "61420a517a406bb6fff8899e7a473e0c57460d794d7c4e70035d4111476a5b4c4b503f54694354efda8f645a6840700340403b427642295d4b7c745201",
    250: "4d496b793f75fe8c65474c0560474a417a4d02ab484a240668eb5d0d7070fa83f564576d5c7050483b41680f6a4c094a724f31",
    251: "62415c4b7ad20d564446084c595c7a4d4b717243789ca896755d7a433f",
    252: "77414b3b587645564f4e0c777f553b7a7e4ffa9b6d008164523c6f3f477372aa7d69486d350233",
    253: "6eeb35aae2929a345076586a42413b4a7e48774d07245958764d4f004d4547404e00b54750767b07",
    254: "6d4fe4939a2f06350f494b500e7f437b115a41570c7d7b4574717a2cf78a7d4fe845437f3c6b493f6ae27b6c0d68745e7146b16180cf958a334e730c704d415409546a4844465a00",
    255: "64416c76490631355e4d915c0278585144300978e2dd8c34567074257c424d023b486a450347560e4f6a4256034c7ade557e7d73434931",
    256: "4b4f480e7b736f4c563a13c2929a66473f4d6d46274046557a0e504c58445e024d474408",
    257: "61de4d43710752094f45f8f2b68e977102744966a5274c4e465c4b06766f03475d1f",
    258: "7e4b478a067e524b035142563e6be470474c7c27fe65b66760723e",
    259: "59616b77efde7e5a440c695f6f7b09454f50746f3b724bb697861e407048660d030343526c5a024f414a480268475940060007",
    260: "605c538a0e4d717b0f4041fc78071e310c556b6d6b0d4af89fdf644e5b4b115e6a7f4b4642005c52405d537b33084375470c5e4b4db6b662774a16524a5c43745f2b54454f73ab4ff0000c35",
    261: "67114452685cde4b5d5c50660b266a0a4408f4f3f1e694917d4c780c6b4c0d5e41486824504c58440c724154746e00",
    262: "6841534f460f0c00de71475d463031006f7e40484d75093106",
    263: "63620642425c4f4f6f4857b8d4d12973414a08697a5f3f714c775114574f4d554042440869467370900e767e4e020635",
    264: "6e6b08597a55064209454e685944fd6c015d41de424b694915774c3b5c764e500c414842e593906f030007",
    265: "7c7754036c4e7442574340443d7c4d50450345545a5cde414b17684872455b41425c473f7242075d44e25e00444d7151767470b8",
    266: "ad976c5c430940560d405a0747476e4b465d4b5033236576624f5d4017",
    267: "4a964c084d4a76724d5b495f0d000c247577456942034e526b493f5946f3da9c644a497b5c47710a4546404caa",
    268: "635b3f487e564a7368435d31d0030e7a407a3b5948590e4d715d662c56fa9b86684349096c7a5c4c40024f4c49023506",
    269: "686b3d417a423c690e7d49df3d5343473f7d42460e48294df779476d4d3f55675c426c48036d7093476f457244412555fe9b8b344670496c4d0a590942694b4c034d594a5b591c3f",
    270: "560e517a4b0704d0633b5f4b4c004756310f35",
}


ig_msg_e_digest = "540a862fc08283823b61d8f56a39d08636348e0c273c5b4c99ddd6a25e343c91"
subtitles_en_digest = "ea45d6e4fb195f521a215e3fac27609b9f2b6abc84590ce0c6a10b07d9d4aa6d"


def xor(first, second):
    return bytes(x ^ y for x, y in zip(first, second))


def decode_english_subtitles(ig_msg_e: BinaryIO):
    pos = ig_msg_e.tell()
    ig_msg_e.seek(0, os.SEEK_SET)
    ig_msg_e_bin = ig_msg_e.read()
    ig_msg_e.seek(pos, os.SEEK_SET)

    computed_ig_msg_e_digest = hashlib.sha256(ig_msg_e_bin).hexdigest()
    if computed_ig_msg_e_digest != ig_msg_e_digest:
        raise RuntimeError("IG_MSG_E.OBJ digest mismatch")

    sorted_subs = [(num, bytes.fromhex(enc)) for num, enc in subtitles_en_encoded.items()]
    sorted_subs.sort(key=lambda x: x[0])

    sub_size = sum(len(sub) for _, sub in sorted_subs)
    xor_base = ig_msg_e_bin.replace(b"\x00", b"")[:sub_size]

    position = 0
    decoded_subs = dict()
    sha256_hash = hashlib.sha256()
    for num, enc in sorted_subs:
        dec = xor(xor_base[position:], enc)
        position += len(enc)
        sha256_hash.update(dec)
        decoded_subs[num] = dec.decode("utf-8")

    decoded_sub_digest = sha256_hash.hexdigest()

    if decoded_sub_digest != subtitles_en_digest:
        raise RuntimeError("subtitle digest mismatch")

    return decoded_subs


def encode_english_subtitles(ig_msg_e: BinaryIO, subs_e: dict[int, str]):
    pos = ig_msg_e.tell()
    ig_msg_e.seek(0, os.SEEK_SET)
    ig_msg_e_bin = ig_msg_e.read()
    ig_msg_e.seek(pos, os.SEEK_SET)

    computed_ig_msg_e_digest = hashlib.sha256(ig_msg_e_bin).hexdigest()
    if computed_ig_msg_e_digest != ig_msg_e_digest:
        raise RuntimeError("IG_MSG_E.OBJ digest mismatch")

    sub_size = sum(len(sub) for sub in subs_e.values())
    xor_base = ig_msg_e_bin.replace(b"\x00", b"")[:sub_size]

    position = 0
    sha256_hash = hashlib.sha256()
    encoded_sub_e: dict[int, str] = {}
    for num, sub in subs_e.items():
        sub_bytes = sub.encode("utf-8")
        enc = xor(xor_base[position:], sub_bytes)
        position += len(sub)
        sha256_hash.update(sub_bytes)
        encoded_sub_e[num] = enc.hex()

    decoded_sub_digest = sha256_hash.hexdigest()

    return encoded_sub_e, decoded_sub_digest
